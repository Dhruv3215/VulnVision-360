#### THIS COMMAND WILL UPDATE AND UPGRADE YOUR SYSTEM AND PACKAGES .
```
sudo apt update && apt upgrade -y
```

### INSTALLING AND SET-UP OF Greenbone Vulnerability Manager(GVM)
---

#### THIS COMMAND WILL INSTALL Greenbone Vulnerability Manager(GVM SCANNER) .
```
sudo apt install gvm -y
```
#### THIS COMMAND WILL SETUP THE SCANNER AND DOWNLOAD REQUIRED PACKAGES .
```
sudo gvm-set-up
```

# ISSUE 

## GVM PostgreSQL Collation Version Mismatch Fix

## Problem Description

When running `gvm-setup` or attempting to create the GVM PostgreSQL database, you may encounter a collation version mismatch error.

### Error Messages

```
WARNING: database "postgres" has a collation version mismatch
DETAIL: The database was created using collation version 2.41, but the operating system provides version 2.42.
HINT: Rebuild all objects in this database that use the default collation and run ALTER DATABASE postgres REFRESH COLLATION VERSION, or build PostgreSQL with the right library version.

ERROR: The Postgresql DB does not exist.
FIX: Run 'sudo runuser -u postgres -- /usr/share/gvm/create-postgresql-database'

ERROR: Your GVM-25.04.0 installation is not yet complete!
```

When attempting to create the database:

```
createdb: error: database creation failed: ERROR: template database "template1" has a collation version mismatch
DETAIL: The template database was created using collation version 2.41, but the operating system provides version 2.42.
```

## Root Cause

This issue occurs when:
- PostgreSQL's system locales/collations are updated (typically after a system upgrade)
- The existing PostgreSQL databases were created with an older collation version
- Template databases (`template0`, `template1`, `postgres`) need to be refreshed before new databases can be created

## Solution

### Step 1: Update PostgreSQL Template Database Collations

```bash
sudo -u postgres psql << EOF
ALTER DATABASE template0 REFRESH COLLATION VERSION;
ALTER DATABASE template1 REFRESH COLLATION VERSION;
ALTER DATABASE postgres REFRESH COLLATION VERSION;
EOF
```

**Expected Output:**
```
NOTICE: changing version from 2.41 to 2.42
ALTER DATABASE
NOTICE: changing version from 2.41 to 2.42
ALTER DATABASE
NOTICE: changing version from 2.41 to 2.42
ALTER DATABASE
```

### Step 2: Reindex Template Databases

```
sudo -u postgres psql template1 -c "REINDEX DATABASE template1;"
sudo -u postgres psql postgres -c "REINDEX DATABASE postgres;"
```

### Step 3: Create GVM PostgreSQL Database

```
sudo runuser -u postgres -- /usr/share/gvm/create-postgresql-database
```

**Expected Output:**
```
[i] User _gvm already exists in PostgreSQL
[*] Creating database
[*] Creating permissions
[*] Applying permissions
[*] Creating extension uuid-ossp
[*] Creating extension pgcrypto
[*] Creating extension pg-gvm
```

### Step 4: Complete GVM Setup Again Run The Command 

```
sudo gvm-setup
```
---

## Note:- Save the password of admin user in any file . It will look like: 
```
[+] Done
[*] Please note the password for the admin user
[*] User created with password '<AUTO-GENERATED-PASSWORD>'.
```

## Environment

- **System**: Kali Linux / Debian-based distributions
- **GVM Version**: 25.04.0
- **PostgreSQL**: 15+ (version may vary)
- **Issue Date**: Typically occurs after system/locale updates

## Additional Resources

- [PostgreSQL Collation Documentation](https://www.postgresql.org/docs/current/collation.html)
- [GVM Documentation](https://greenbone.github.io/docs/)
- [Kali GVM Guide](https://www.kali.org/tools/gvm/)

#### THIS COMMAND WILL Verify the installation .
```
sudo gvm-check-setup
```
#### THIS COMMAND WILL START GVM SCANNER SERVICES .
```
sudo gvm-start
```


### Access the web interface

Open Ip Address displayed at previous result in browser

### Login with given username and password from setup command.

#### THIS COMMAND IS USED FOR CHANGING PASSWORD FOR PERTICULAR USER .
```
sudo -u _gvm gvmd --user=<USERNAME> --new-password=<YOUR_NEW_PASSWORD>
```

## NMAP SET-UP

#### # Nmap is pre-installed on Kali, but verify
```
nmap --version
```

#### If not installed run this command:
```
sudo apt install nmap
```


# Now we have successfully completed installation and set-up Greenbone Vulnerability Manager(GVM) and nmap.
